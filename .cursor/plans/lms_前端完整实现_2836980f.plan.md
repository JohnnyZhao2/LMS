---
name: LMS 前端完整实现
overview: 基于 Django REST Framework 后端 API，实现完整的企业级学习管理系统前端，包括认证、角色切换、仪表盘、知识中心、任务管理、评分等核心功能模块。
todos:
  - id: setup-dependencies
    content: 安装依赖：antd, react-router-dom, @tanstack/react-query, dayjs 等
    status: completed
  - id: setup-config
    content: 配置 TypeScript 路径别名、Vite 配置、环境变量
    status: completed
  - id: api-client
    content: 实现 API 客户端：Fetch 封装、Token 存储、React Query 配置
    status: completed
    dependencies:
      - setup-dependencies
  - id: auth-system
    content: 实现认证系统：Auth Context、登录/登出、Token 刷新、角色切换
    status: completed
    dependencies:
      - api-client
  - id: layout-components
    content: 实现布局组件：Header（含角色切换器）、Sidebar（动态菜单）、Layout 容器
    status: completed
    dependencies:
      - auth-system
  - id: routing
    content: 实现路由系统：路由配置、路由守卫、按角色动态路由
    status: completed
    dependencies:
      - layout-components
  - id: dashboard-module
    content: 实现仪表盘模块：学员/导师/团队经理三种仪表盘
    status: completed
    dependencies:
      - routing
  - id: knowledge-module
    content: 实现知识中心模块：列表、详情、筛选、搜索
    status: completed
    dependencies:
      - routing
  - id: tasks-module
    content: 实现任务中心模块：任务列表、详情、创建表单（三种类型）
    status: completed
    dependencies:
      - routing
  - id: submissions-module
    content: 实现答题提交模块：答题界面、计时器、答案保存、答题回顾
    status: completed
    dependencies:
      - tasks-module
  - id: grading-module
    content: 实现评分中心模块：待评分列表、评分表单、批量评分
    status: completed
    dependencies:
      - submissions-module
  - id: management-modules
    content: 实现管理模块：试卷管理、题库管理、用户管理、抽查中心
    status: completed
    dependencies:
      - grading-module
  - id: types-definition
    content: 从 OpenAPI Schema 提取并定义所有 TypeScript 类型
    status: completed
  - id: error-handling
    content: 实现全局错误处理和用户友好的错误提示
    status: completed
    dependencies:
      - api-client
  - id: theme-styling
    content: 配置 Ant Design 主题和自定义样式，符合设计美学规范
    status: completed
    dependencies:
      - layout-components
---

# LMS 前端完整实现计划



## 技术栈选择

- **UI 库**: Ant Design 5.x
- **路由**: React Router v6
- **状态管理**: React Query (TanStack Query) + Context API
- **API 客户端**: Fetch API + React Query
- **样式**: CSS Modules + Ant Design 主题定制
- **类型**: TypeScript (从 OpenAPI Schema 手动定义类型)

## 项目结构

```javascript
lms_frontend/src/
├── app/
│   ├── routes/              # 路由配置
│   ├── provider.tsx         # 全局 Provider (React Query, Auth Context)
│   ├── router.tsx           # 路由组件
│   └── app.tsx              # 根组件
├── components/
│   ├── ui/                  # 基础 UI 组件 (基于 Ant Design 封装)
│   ├── layout/               # 布局组件
│   │   ├── header.tsx       # 顶部导航（含角色切换器）
│   │   ├── sidebar.tsx      # 侧边栏菜单（按角色动态）
│   │   └── layout.tsx       # 主布局容器
│   └── protected-route.tsx # 路由守卫
├── features/
│   ├── auth/                # 认证模块
│   │   ├── api/
│   │   │   ├── login.ts
│   │   │   ├── logout.ts
│   │   │   ├── refresh-token.ts
│   │   │   └── switch-role.ts
│   │   ├── components/
│   │   │   └── login-form.tsx
│   │   ├── hooks/
│   │   │   └── use-auth.ts
│   │   ├── stores/
│   │   │   └── auth-context.tsx
│   │   └── types.ts
│   ├── dashboard/           # 仪表盘（按角色）
│   │   ├── api/
│   │   │   ├── student-dashboard.ts
│   │   │   ├── mentor-dashboard.ts
│   │   │   └── team-manager-dashboard.ts
│   │   └── components/
│   │       ├── student-dashboard.tsx
│   │       ├── mentor-dashboard.tsx
│   │       └── team-manager-dashboard.tsx
│   ├── knowledge/           # 知识中心
│   │   ├── api/
│   │   │   ├── get-knowledge-list.ts
│   │   │   ├── get-knowledge-detail.ts
│   │   │   └── get-categories.ts
│   │   ├── components/
│   │   │   ├── knowledge-list.tsx
│   │   │   ├── knowledge-card.tsx
│   │   │   ├── knowledge-detail.tsx
│   │   │   └── knowledge-filters.tsx
│   │   └── types.ts
│   ├── tasks/               # 任务中心
│   │   ├── api/
│   │   │   ├── get-tasks.ts
│   │   │   ├── get-task-detail.ts
│   │   │   ├── create-task.ts
│   │   │   └── complete-learning.ts
│   │   ├── components/
│   │   │   ├── task-list.tsx
│   │   │   ├── task-card.tsx
│   │   │   ├── task-detail.tsx
│   │   │   ├── task-form/
│   │   │   │   ├── learning-task-form.tsx
│   │   │   │   ├── practice-task-form.tsx
│   │   │   │   └── exam-task-form.tsx
│   │   │   └── assignment-selector.tsx
│   │   └── types.ts
│   ├── submissions/         # 答题提交
│   │   ├── api/
│   │   │   ├── start-practice.ts
│   │   │   ├── start-exam.ts
│   │   │   ├── save-answer.ts
│   │   │   ├── submit.ts
│   │   │   └── get-result.ts
│   │   ├── components/
│   │   │   ├── quiz-player.tsx      # 答题界面
│   │   │   ├── question-card.tsx
│   │   │   ├── answer-review.tsx    # 答题回顾
│   │   │   └── timer.tsx
│   │   └── types.ts
│   ├── quizzes/             # 试卷管理
│   │   ├── api/
│   │   │   ├── get-quizzes.ts
│   │   │   ├── create-quiz.ts
│   │   │   └── manage-questions.ts
│   │   ├── components/
│   │   │   ├── quiz-list.tsx
│   │   │   ├── quiz-editor.tsx
│   │   │   └── question-selector.tsx
│   │   └── types.ts
│   ├── questions/           # 题库管理
│   │   ├── api/
│   │   │   ├── get-questions.ts
│   │   │   ├── create-question.ts
│   │   │   └── batch-import.ts
│   │   ├── components/
│   │   │   ├── question-list.tsx
│   │   │   ├── question-form.tsx
│   │   │   └── question-import.tsx
│   │   └── types.ts
│   ├── grading/             # 评分中心
│   │   ├── api/
│   │   │   ├── get-pending-grading.ts
│   │   │   ├── get-grading-detail.ts
│   │   │   └── submit-grade.ts
│   │   ├── components/
│   │   │   ├── grading-list.tsx
│   │   │   ├── grading-form.tsx
│   │   │   └── answer-review-panel.tsx
│   │   └── types.ts
│   ├── spot-checks/          # 抽查中心
│   │   ├── api/
│   │   │   ├── get-spot-checks.ts
│   │   │   ├── create-spot-check.ts
│   │   │   └── update-spot-check.ts
│   │   ├── components/
│   │   │   ├── spot-check-list.tsx
│   │   │   └── spot-check-form.tsx
│   │   └── types.ts
│   ├── users/               # 用户管理（管理员）
│   │   ├── api/
│   │   │   ├── get-users.ts
│   │   │   ├── create-user.ts
│   │   │   └── manage-roles.ts
│   │   ├── components/
│   │   │   ├── user-list.tsx
│   │   │   ├── user-form.tsx
│   │   │   └── role-assignment.tsx
│   │   └── types.ts
│   └── notifications/       # 通知
│       ├── api/
│       │   └── get-notifications.ts
│       └── components/
│           └── notification-bell.tsx
├── lib/
│   ├── react-query.ts       # React Query 配置
│   ├── api-client.ts        # Fetch API 封装
│   └── token-storage.ts     # Token 存储工具
├── config/
│   ├── index.ts            # 全局配置
│   └── routes.ts            # 路由配置常量
├── hooks/
│   └── use-role-menu.ts    # 角色菜单 Hook
├── types/
│   └── api.ts              # API 类型定义（从 OpenAPI 提取）
└── utils/
    ├── format.ts           # 格式化工具
    └── permissions.ts      # 权限检查工具
```



## 实现步骤

### 阶段 1: 基础架构搭建

1. **依赖安装**

- `antd`, `@ant-design/icons`
- `react-router-dom`
- `@tanstack/react-query`
- `dayjs` (日期处理)

2. **配置文件**

- `tsconfig.json` 配置路径别名 `@/`
- `vite.config.ts` 配置路径别名
- `.env` 配置 API 基础 URL

3. **API 客户端**

- `lib/api-client.ts`: Fetch 封装，自动添加 JWT token，处理刷新
- `lib/token-storage.ts`: Token 存储（localStorage）
- `lib/react-query.ts`: React Query 配置和默认选项

4. **认证系统**

- `features/auth/stores/auth-context.tsx`: 全局认证状态
- `features/auth/hooks/use-auth.ts`: 认证相关 hooks
- `features/auth/api/`: 登录、登出、刷新、角色切换 API

5. **路由系统**

- `app/router.tsx`: 路由配置，按角色动态加载
- `components/protected-route.tsx`: 路由守卫
- `config/routes.ts`: 路由常量定义

6. **布局组件**

- `components/layout/layout.tsx`: 主布局容器
- `components/layout/header.tsx`: 顶部导航，包含角色切换器
- `components/layout/sidebar.tsx`: 侧边栏，根据当前角色动态显示菜单

### 阶段 2: 核心功能模块

7. **仪表盘模块** (`features/dashboard/`)

- 学员仪表盘：待办任务、最新知识、统计卡片
- 导师/室经理仪表盘：学员完成率、待评分数量
- 团队经理仪表盘：数据看板、知识热度

8. **知识中心模块** (`features/knowledge/`)

- 知识列表：卡片展示、分类筛选、搜索
- 知识详情：Markdown 渲染、目录导航、完成按钮（任务场景）

9. **任务中心模块** (`features/tasks/`)

- 任务列表：按类型和状态筛选
- 任务详情：展示子任务（知识/试卷）
- 任务创建表单：学习/练习/考试三种类型
- 人员选择器：按角色范围筛选

10. **答题提交模块** (`features/submissions/`)

    - 答题界面：题目导航、计时器、答案保存
    - 答题回顾：显示解析、重做功能（练习）
    - 考试模式：防作弊、限时、禁止重做

11. **评分中心模块** (`features/grading/`)

    - 待评分列表：筛选和排序
    - 评分表单：题目展示、答案展示、评分输入
    - 批量评分功能

### 阶段 3: 管理功能模块

12. **试卷管理** (`features/quizzes/`)

    - 试卷列表和 CRUD
    - 组卷编辑器：添加题目、调整顺序、设置分数

13. **题库管理** (`features/questions/`)

    - 题目列表和 CRUD
    - 题目表单：单选/多选/判断/简答
    - 批量导入功能

14. **用户管理** (`features/users/`) - 管理员专用

    - 用户列表和 CRUD
    - 角色分配
    - 组织架构管理

15. **抽查中心** (`features/spot-checks/`)

    - 抽查记录列表
    - 创建抽查表单

16. **通知模块** (`features/notifications/`)

    - 通知列表
    - 未读数量显示

### 阶段 4: 优化和细节

17. **类型定义**

    - 从 `openapi-schema.yaml` 提取所有类型定义到 `types/api.ts`
    - 确保类型安全

18. **错误处理**

    - 全局错误边界
    - API 错误统一处理
    - 友好的错误提示

19. **加载状态**

    - 骨架屏
    - Loading 状态统一处理

20. **响应式设计**

    - 移动端适配
    - 侧边栏折叠

21. **主题定制**

    - Ant Design 主题配置
    - 符合设计美学规范（避免通用 AI 风格）

## 关键实现细节

### 角色切换机制

- 切换角色时调用 `/api/auth/switch-role/` 获取新 token
- 更新 Auth Context 中的当前角色
- 重新渲染侧边栏菜单
- 重定向到新角色的默认页面

### 路由权限控制

- 使用 `ProtectedRoute` 组件包装需要认证的路由
- 根据当前角色检查路由权限
- 无权限时重定向到仪表盘

### API 类型安全

- 手动从 OpenAPI Schema 提取类型定义
- 确保请求和响应类型匹配
- 使用 TypeScript 严格模式

### 答题界面防作弊

- 考试模式禁用浏览器后退
- 页面失焦检测（可选）
- 倒计时显示
- 自动保存答案

## 设计美学要求

- **字体**: 选择独特字体（避免 Inter/Roboto），如 "PingFang SC" 或 "Source Han Sans"
- **配色**: 企业级配色方案，使用 CSS 变量统一管理
- **动效**: 页面加载使用 staggered reveal 动画
- **背景**: 使用渐变或几何图案，避免纯色背景

## 文件清单

主要修改/创建的文件：

- `package.json` - 添加依赖
- `tsconfig.json` - 路径别名配置
- `vite.config.ts` - 路径别名和代理配置
- `src/app/` - 应用层配置
- `src/components/` - 共享组件
- `src/features/` - 功能模块（10+ 个模块）
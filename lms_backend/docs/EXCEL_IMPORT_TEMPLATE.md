# Excel题目导入模板说明

## 文件格式

- 文件格式：`.xlsx` (Excel 2007及以上版本)
- 文件大小：不超过10MB

## Excel列定义

| 列 | 字段名 | 说明 | 必填 | 示例 |
|----|--------|------|------|------|
| A | 题目类型 | 单选题/多选题/判断题/简答题 | 是 | `单选题` 或 `SINGLE` |
| B | 题目内容 | 题目的问题描述 | 是 | `Python中哪个关键字用于定义函数？` |
| C | 选项 | JSON格式的选项（简答题可为空） | 选择题必填 | `{"A": "def", "B": "function", "C": "func", "D": "define"}` |
| D | 正确答案 | JSON格式的答案 | 是 | `{"answer": "A"}` |
| E | 题目解析 | 答案解析说明 | 否 | `def是Python中定义函数的关键字` |
| F | 难度 | 1-5的整数 | 否 | `3` (默认为3) |
| G | 是否公开 | true/false 或 是/否 | 否 | `true` 或 `是` (默认为false) |

## 题目类型说明

支持以下题目类型（中英文均可）：

- **单选题**: `单选题`、`单选`、`SINGLE`
- **多选题**: `多选题`、`多选`、`MULTIPLE`
- **判断题**: `判断题`、`判断`、`JUDGE`
- **简答题**: `简答题`、`简答`、`ESSAY`

## 选项格式 (列C)

### 单选题/多选题
```json
{"A": "选项A的内容", "B": "选项B的内容", "C": "选项C的内容", "D": "选项D的内容"}
```

### 判断题
```json
{"A": "正确", "B": "错误"}
```
或
```json
{"A": "True", "B": "False"}
```

### 简答题
留空或填写 `null`

## 正确答案格式 (列D)

### 单选题
```json
{"answer": "A"}
```

### 多选题
```json
{"answer": ["A", "B", "C"]}
```

### 判断题
```json
{"answer": true}
```
或
```json
{"answer": false}
```

### 简答题
```json
{"answer": "参考答案内容"}
```

## 完整示例

### 示例1：单选题

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| 单选题 | Python中哪个关键字用于定义函数？ | {"A": "def", "B": "function", "C": "func", "D": "define"} | {"answer": "A"} | def是Python中定义函数的关键字 | 2 | true |

### 示例2：多选题

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| 多选题 | 以下哪些是Python的数据类型？ | {"A": "int", "B": "string", "C": "list", "D": "array"} | {"answer": ["A", "B", "C"]} | Python内置数据类型包括int、str、list等 | 3 | false |

### 示例3：判断题

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| 判断题 | Python是一种编译型语言 | {"A": "正确", "B": "错误"} | {"answer": false} | Python是解释型语言，不是编译型语言 | 2 | true |

### 示例4：简答题

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| 简答题 | 请简述Python中列表和元组的区别 | | {"answer": "列表是可变的，元组是不可变的"} | 列表使用[]定义，可以修改；元组使用()定义，不可修改 | 4 | false |

## 导入流程

1. 准备Excel文件，按照上述格式填写题目数据
2. 第一行为标题行（可选，系统会自动跳过）
3. 从第二行开始填写题目数据
4. 调用导入API：`POST /api/questions/import/`
5. 上传Excel文件
6. 系统返回导入结果，包括成功数量和错误记录

## API调用示例

### 请求

```bash
curl -X POST \
  http://localhost:8000/api/questions/import/ \
  -H 'Authorization: Bearer YOUR_JWT_TOKEN' \
  -H 'Content-Type: multipart/form-data' \
  -F 'file=@questions.xlsx'
```

### 响应示例（成功）

```json
{
  "success": true,
  "message": "导入完成：成功 10 条",
  "data": {
    "success_count": 10,
    "error_count": 0,
    "errors": []
  }
}
```

### 响应示例（部分失败）

```json
{
  "success": true,
  "message": "导入完成：成功 8 条，失败 2 条",
  "data": {
    "success_count": 8,
    "error_count": 2,
    "errors": [
      {
        "row": 3,
        "error": "选项格式错误，必须是有效的JSON格式"
      },
      {
        "row": 5,
        "error": "题目类型、内容和正确答案为必填项"
      }
    ]
  }
}
```

## 常见错误

1. **"只支持.xlsx格式的Excel文件"**
   - 请确保文件是Excel 2007及以上版本的.xlsx格式

2. **"题目类型、内容和正确答案为必填项"**
   - 检查A、B、D列是否都有填写

3. **"不支持的题目类型"**
   - 题目类型必须是：单选题、多选题、判断题、简答题之一

4. **"选项格式错误，必须是有效的JSON格式"**
   - 检查C列的JSON格式是否正确，注意使用双引号

5. **"正确答案格式错误，必须是有效的JSON格式"**
   - 检查D列的JSON格式是否正确

6. **"单选题答案必须是字符串"**
   - 单选题答案格式：`{"answer": "A"}`

7. **"多选题答案必须是列表"**
   - 多选题答案格式：`{"answer": ["A", "B"]}`

8. **"判断题答案必须是布尔值"**
   - 判断题答案格式：`{"answer": true}` 或 `{"answer": false}`

## 注意事项

1. Excel文件第一行可以是标题行，系统会自动跳过
2. 每行数据独立处理，某行失败不影响其他行
3. 导入过程是同步的，大文件可能需要较长时间
4. 建议单次导入不超过1000条题目
5. 导入的题目创建人为当前登录用户
6. JSON格式必须使用双引号，不能使用单引号
7. 难度值必须是1-5之间的整数
8. 是否公开字段支持：true/false、是/否、1/0、yes/no

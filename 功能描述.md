一、项目概况与总体原则
- 技术栈：前端 React，后端 Django
- 核心目标：实现 “学、练、考、评” 的能力闭环
- 架构铁律：资源与任务分离（先有资源，后发任务）
- 组织结构：一室 / 二室
- 角色基础规则：
  - 默认角色：普通学员（仅学员菜单）
  - 高权限角色（导师 / 室经理 / 管理员）：支持顶部角色切换
  - 角色切换后：菜单、路由、接口权限全部实时刷新，禁止跨角色残留

---
二、核心业务流程（学 / 练 / 考 / 评）
本系统的业务流程只围绕 资源生产 → 任务发布 → 人员执行 → 结果评估 展开，不讨论页面形态与标签细节。

---
2.1 学（Learning）流程
目标：让学员完成指定知识的学习确认。
流程定义：
1. 管理员维护知识文档（内容本身）
2. 导师 / 室经理 / 管理员创建【学习任务】
  - 选择知识文档（可多选）
  - 选择学员
3. 学员进入任务 → 阅读知识 → 点击「我已学习掌握」
4. 系统记录完成状态（完成 / 未完成）
规则约束：
- 学习任务只关心“是否完成”，不产生分数
- 知识文档只能通过任务产生学习完成记录

---
2.2 练（Practice）流程
目标：通过反复练习巩固知识点。
流程定义：
1. 导师 / 室经理 / 管理员在【测试中心】维护题目与试卷
2. 创建【练习任务】
  - 选择试卷（可多选）
  - 可选关联知识文档
  - 选择学员
3. 学员进入任务 → 答题 → 提交
4. 系统自动判分并展示解析
5. 学员可多次重做
规则约束：
- 练习任务允许重复提交
- 练习成绩用于个人能力分析，但不作为强制考核结果

---
2.3 考（Exam）流程
目标：对阶段性能力进行正式评估。
流程定义：
1. 管理员 / 导师 / 室经理在【测试中心】维护试卷
2. 创建【考试任务】
  - 选择唯一试卷
  - 设置考试时间窗口、限时、防作弊规则
  - 选择学员
3. 学员在规定时间内进入考试并作答
4. 系统自动提交试卷
5. 客观题自动评分，主观题进入人工评分
规则约束：
- 考试任务仅允许一次作答
- 禁止重做
- 未完成评分前，考试结果为“待完成”状态

---
2.4 评（Evaluation）流程
目标：形成对学员能力的综合评估。
评估数据来源：
- 学习任务完成情况
- 练习任务成绩与错题
- 考试任务最终成绩
- 抽查评分记录
流程定义：
1. 系统汇总各类任务与抽查数据
2. 导师 / 室经理查看所辖人员能力情况
3. 团队经理查看跨团队数据看板

---
2.5 资源 / 任务 / 学员结果统一规则
为避免“资源内容”与“任务执行”互相污染，知识、题目、试卷等资源统一遵循版本化管理，任务只绑定资源快照，学员结果只保存历史事实。

2.5.1 核心概念
- **资源（母版）**：知识、题目、试卷等内容本身。一个资源可以拥有多个版本（草稿 / 已发布 / 新版本），已发布版本冻结，只能通过“创建新版本”继续迭代。
- **任务**：一次性发放行为，绑定资源版本快照，携带发放对象、时间窗口、考试设置等调度信息。任务发布后不可修改，只能终止或查看。
- **学员结果**：记录学员对某个任务的作答、成绩、完成状态和评分，仅与任务绑定，不与可变资源直接关联。

2.5.2 版本与快照流程
1. 创建或编辑资源时只修改当前草稿，不影响任何已发布版本。
2. 发布资源 = 生成新的资源版本，旧版本保持可查不可改。
3. 发布任务时必须选择具体资源版本快照：
   - 学习任务：为每个知识版本生成 TaskKnowledge 快照；
   - 练习 / 考试任务：为所选试卷版本（含题目结构和分值）生成 TaskQuiz 快照；
4. 任务生成后所有下游（任务列表、学员结果、评分）都读取快照，不再访问可变的母版数据。

2.5.3 字段归属与不可变性
- 内容类字段（正文、题干、选项、解析、题目顺序、分值、及格线等）归属资源版本，任何修改都通过“新版本”实现。
- 调度类字段（发放对象、开始/截止时间、考试时长、防作弊设置等）归属任务，任务一经发布即冻结。
- 学员操作字段（作答记录、附件、成绩、完成状态、人工评分）只写入学员结果，禁止回写任务或资源。
- 历史任务与学员结果不可修改，只允许新增评分、标记完成等与事实状态一致的操作；如需调整，必须创建新的任务。

2.5.4 影响范围
- 资源修改只影响未来任务：任何新版本必须重新发布任务才能生效，已有任务继续使用旧版本快照。
- 任务进行中禁止对已绑定的资源版本进行结构性修改（删除题目、重排分值等），只能在资源层创建新版本并用于下一次任务。
- 知识、题目、试卷的删除 / 作废需额外校验是否被快照引用，引用中禁止删除。

2.5.5 字段归属判断法（复用规则）
若字段归属不明确，使用“复用规则”判断：
- 同一资源被多个任务复用时如果字段值必须一致 → 资源字段；
- 随任务、分配对象或时间可能变化 → 任务字段；
- 与具体学员互动产生的数据（作答、得分、提交轨迹）→ 学员结果字段。
该规则适用于知识 / 题目 / 试卷等所有资源类型，保证内容母版、任务调度、学员事实三者清晰分离。

---
三、任务（Tasks）——只存在于“任务管理 / 任务中心”
系统仅允许三种任务类型，所有角色菜单围绕它们展开。

---
四、学员角色菜单（任务执行端）
4.1 仪表盘
- 数据聚合逻辑：
  - 待办任务（学习 / 练习 / 考试）
  - 最新知识（知识资源）
4.2 知识中心（资源视角）
知识中心是学员侧唯一直接感知标签体系的地方，标签在此被完整映射为筛选与浏览结构。
内容分类与筛选结构（学员可见）
- 一级筛选（领域大类）：
  - 双云 / 网络 / 数据库 / 应用 / 应急场景 / 规章制度
- 二级筛选（系统对象）：
  - 当选择某一大类后，动态加载对应的系统对象标签
  - 例如：手机银行 / 数字人民币 / 核心系统 等
- 操作标签（行为维度）：
  - 以标签形式展示在知识卡片或详情页中
  - 如：重启 / 隔离 / 扩容 / 应急切换
知识列表展示规则
- 卡片头部：操作标签（用于快速识别知识性质）
- 卡片主体：知识标题 + 内容摘要（2–3 行）
- 卡片底部：修改人 · 修改时间
知识详情页
- 主体区域：
  - 应急类知识：按结构化字段顺序展示（仅展示已填写部分）
  - 其他类型：Markdown / 富文本正文
- 右侧：
  - 内容目录（自动生成锚点）
- 底部行为：
  - 若从学习任务进入：显示「我已学习掌握」按钮
  - 若从知识中心进入：仅浏览，不影响任务状态

---
4.3 任务中心（核心）
任务列表
- 筛选维度：
  - 类型：学习 / 练习 / 考试
  - 状态：进行中 / 已完成 / 已逾期
任务详情（按类型分流）
A. 学习任务
- 任务标题，任务介绍。分配人，任务数量，截止时间，整体进度
- 知识文档列表（子任务）
子任务未完成状态：
- 状态：未完成
- 操作：进入学习
- 进入后需点击「我已学习掌握」
子任务已完成状态：
- 显示知识标题
- 状态：已完成
- 显示完成时间
- 操作：查看内容（只读）
整体任务完成规则说明：
- 所有知识子任务完成后，学习任务状态变为「已完成」
B. 练习任务
任务标题，任务介绍。分配人，任务数量，截止时间，整体进度
- 关联知识列表（可点开）
- 试卷列表（子任务）
子任务未完成状态：
- 显示试卷名称
- 状态：未作答
- 操作：开始练习
子任务已完成状态：
- 显示试卷名称
- 最近成绩
- 最佳成绩
- 作答次数
- 操作：再次练习 / 查看解析
整体任务完成规则说明：
- 至少完成一次所有试卷后，练习任务状态变为「已完成」
C. 考试任务
展示任务标题，任务介绍，题目数量，考试时长，及格分数，开始时间，截止时间
- 操作：进入考试 / 查看结果
4.4 个人中心
- 显示信息：姓名、团队、角色、历史成绩、错题本（来源于练习/考试）
- 行为：查看任务/考试详情、导出记录

---
五、导师 & 室经理菜单（内容生产 + 任务分配）
两者菜单结构一致，仅数据可见范围不同（导师=名下学员，室经理=本室）
5.1 仪表盘
- 所辖人员完成率、平均分
- 待评分考试数量
- 快捷入口：新建任务 / 测试中心 / 抽查

---
5.2 测试中心（Test Center｜核心资源菜单）
统一的题目与试卷资源池，所有任务均从这里取资源
5.2.1 题目管理（Question Bank）
- 资源属性：全平台共享题目资源池
- 题目类型：单选 / 多选 / 判断 / 简答
权限规则（非常关键）：
- 导师 / 室经理：
  - ✅ 可查看所有题目（含管理员创建）
  - ✅ 可创建题目（题目作者 = 自己）
  - ✅ 可编辑 / 删除【自己创建的题目】
  - ❌ 不可编辑 / 删除管理员创建的题目
- 管理员：
  - ✅ 可查看 / 创建 / 编辑 / 删除所有题目
- 题目创建方式：
  - 手动创建
  - Excel 模板批量导入（管理员专属）

---
5.2.2 试卷管理（Quiz / Paper）
- 定位：题目容器（不包含考试规则、不绑定人员）
- 资源属性：全平台共享
创建试卷规则：
- 创建试卷时，可：
  - 勾选【已有题目】（来源：全平台题库）
  - 新建题目并自动纳入题库（题目作者 = 当前用户）
权限规则：
- 导师 / 室经理：
  - ✅ 可查看所有试卷（含管理员创建的标准试卷）
  - ✅ 可创建试卷（仅基于已有题目或自建题目）
  - ✅ 可编辑 / 删除【自己创建的试卷】
  - ❌ 不可编辑 / 删除管理员创建的试卷
- 管理员：
  - ✅ 可创建「标准试卷」（全员可用）
  - ✅ 可编辑 / 删除任意试卷

---
5.3 任务管理（只负责“分配”，不生产资源）
新建任务（统一入口）
- Step 1：选择任务类型（学习 / 练习 / 考试）
- Step 2：选择资源（只允许从【测试中心 / 知识库】选择）
  - 学习任务：知识文档（多选）
  - 练习任务：试卷（多选） + 辅助知识
  - 考试任务：试卷（单选） + 考试规则
- Step 3：人员选择器（自动过滤当前用户）
任务进行中 禁止新建或者修改删除题目或试卷，只能“用资源”

---
5.4 评分中心（仅考试任务）
- 展示来源：考试任务中的主观题提交
- 行为：人工评分 + 评语

---
5.5 抽查中心（独立评估模块）
- 线下执行，线上录入
- 不属于任务系统

---
六、管理员菜单（全局治理层）
管理员负责平台级资源治理、组织与权限配置，不参与具体学习与考试执行。
6.1 测试中心（全权限）
- 题库管理：维护全平台原子题（支持 Excel 批量导入）
- 试卷管理：创建 / 维护公共标准试卷
权限说明：
- 管理员对所有题目与试卷拥有完整 CRUD 权限
- 管理员创建的试卷为「标准试卷」，其他角色仅可查看和使用

---
6.2 知识库管理
本模块仅负责知识文档资源本身的维护，不涉及任务逻辑。
6.2.1 知识文档维护
- 新建 / 编辑 / 删除知识文档
- 支持应急类与非应急类两种正文模式
6.2.2 知识文档字段定义（创建规范）
知识类型（Knowledge Type｜核心约束）
- EMERGENCY：应急 / 操作类（结构化正文）
- OTHER：其他类型（自由正文）
规则：
- 所有知识必须指定 knowledge_type
- 仅应急类启用结构化正文
- 任务系统仅引用知识资源，不感知类型
基础信息
- 标题 / 摘要 / 封面 / 附带链接
分类与标签（用于学员知识中心筛选）
- 所属条线（一级分类）
- 所属系统（二级分类）
- 操作类型（重启 / 隔离 / 停止 / 切换等）
正文内容
- 应急类（EMERGENCY）：
  - 故障场景
  - 触发流程
  - 解决方案
  - 验证方案
  - 恢复方案
  - 字段允许为空，按顺序展示已填写内容
- 其他类型（OTHER）：
  - Markdown / 富文本
  - 不强制结构
责任与归属
- 场景交付人 / 可执行人 / 应急平台
- 创建人 / 创建人所属团队
系统字段（自动）
- 创建时间 / 最后更新时间 / 阅读次数

---
6.3 任务管理（管理员视角）
- 跨团队发布任务
- 强制结束任务

---
6.4 用户与权限
本模块描述的是管理员在「用户与权限」页面能看到什么、能配置什么、每个子页面解决什么问题，用于直接指导页面设计与功能实现。

---
6.4.1 用户列表页（User List）
页面目标：统一管理平台所有用户的账号状态与基础归属信息。
列表字段：
- 姓名 / 工号 / 登录账号
- 当前状态（启用 / 停用）
- 所属室（一室 / 二室）
- 已绑定角色（导师 / 室经理 / 管理员 / 团队经理）
页面能力：
- 新建用户
- 编辑用户基础信息
- 停用 / 启用用户
- 重置密码
约束规则：
- 已产生学习 / 任务 / 考试数据的用户禁止删除
- 停用用户：
  - 无法登录系统
  - 不出现在任何人员选择器中

---
6.4.2 用户详情页（User Detail）
页面目标：集中配置“这个人是谁、能扮演什么角色、归属到哪”。
信息区块：
1. 基础信息
  - 姓名 / 工号 / 登录账号
  - 当前状态
2. 角色配置
  - 默认角色：学员（不可取消）
  - 可附加角色：导师 / 室经理 / 管理员 / 团队经理
3. 组织归属
  - 所属室（单选）

---
6.4.3 角色管理（Role Management）
角色为系统内置枚举，此页面不支持自定义角色，仅用于说明与约束展示。
角色说明展示：
- 学员：仅能查看并执行分配给自己的任务
- 导师：管理名下学员，发布任务
- 室经理：管理本室人员，发布任务
- 管理员：全平台治理
- 团队经理：只读数据分析
本页面用于帮助管理员理解角色边界，不提供 CRUD 能力。

---
6.4.4 组织架构管理（Organization）
页面目标：维护人员在组织中的归属关系。
页面内容：
- 室列表（一室 / 二室）
- 每个室的成员列表
- 当前室经理标识
页面能力：
- 调整用户所属室
- 指定 / 更换室经理
联动规则：
- 室经理权限随指定即时生效
- 变更组织归属不影响历史任务数据

---
6.4.5 师徒关系管理（Mentorship）
页面目标：维护导师与学员之间的管理关系。
页面内容：
- 导师列表
- 每位导师下的学员列表
页面能力：
- 为学员指定导师
- 调整 / 解除师徒关系
规则说明：
- 一个学员同时只能绑定一个导师
- 导师任务发布范围 = 当前绑定学员

---
6.4.6 权限规则说明页（Read-only）
本页用于集中展示系统权限计算规则，不提供配置能力。
展示内容：
- 角色切换生效规则
- 菜单 / 路由 / 接口权限统一受当前角色控制
- 权限来源：
  - 当前登录用户
  - 当前生效角色
  - 组织归属关系
  - 师徒 / 管辖关系
系统中不存在“页面级手动授权”，所有权限均为规则计算结果


---
七、团队经理菜单（只读分析层）
团队数据看板
- 各室完成率与成绩对比
- 知识热度分析
数据全部来源于：学习任务、练习任务、考试任务、抽查记录

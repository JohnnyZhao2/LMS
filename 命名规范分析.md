# 前后端文件和URL命名规范分析

## 发现的问题

### 后端URL命名问题

#### 1. URL路径不一致
- ✅ 大部分使用kebab-case：`/api/spot-checks/`, `/api/knowledge/`
- ❌ 但有些路径命名风格不一致
- ❌ `grading` 路由单独放在 `/api/grading/`，但实际文件在 `apps/submissions/urls_grading.py`

#### 2. URL文件组织不一致
- ✅ 大部分模块：单个 `urls.py` 文件
- ❌ `users` 模块：拆分 `urls/auth.py` 和 `urls/users.py`
- ❌ `submissions` 模块：`urls.py` 和 `urls_grading.py` 两个文件，命名不一致
- ❌ `analytics` 模块：views 拆分到子目录，但 urls 在根目录

#### 3. URL名称（name）命名不一致
- ✅ 有些使用kebab-case：`student-dashboard`, `auth-login`
- ❌ 有些命名缺少前缀一致性：`user-list-create` vs `knowledge-list-create`
- ❌ `spot_checks/urls.py` 中使用了 `app_name = 'spot_checks'`，其他模块都没有

#### 4. URL路径结构不一致
- `/api/analytics/dashboard/student/` - 嵌套路径（`dashboard/student/`）
- `/api/knowledge/student/` - 平级路径（`student/`）
- `/api/tasks/create/` - 平级（`create/`）
- `/api/knowledge/tags/create/` - 嵌套（`tags/create/`）

### 前端路由命名问题

#### 1. 路由路径不一致
- ✅ 大部分使用常量 `ROUTES.XXX`
- ❌ 有些硬编码路径：`/quiz/:id`, `/review/practice`, `/review/exam`
- ❌ 路径命名风格：`/spot-checks` vs `/grading` vs `/tasks`

#### 2. 路由路径与后端API路径不一致
- 前端：`/quiz/:id`
- 后端：`/api/submissions/start/` 或 `/api/submissions/<id>/submit/`

- 前端：`/review/practice`, `/review/exam`
- 后端：`/api/submissions/<id>/result/`

#### 3. 路由文件组织
- ✅ 使用 `router.tsx` 统一管理
- ✅ 路由常量在 `config/routes.ts`
- ❌ 路由定义较分散，所有路由都在一个文件中

#### 4. 页面组件路径命名
- ✅ 大部分使用 features 结构：`features/knowledge/components/`
- ✅ 命名风格一致：`student-knowledge-center.tsx`, `admin-knowledge-list.tsx`
- ✅ 路由页面放在 `app/routes/auth/login.tsx`

### Views文件组织问题

#### 1. Views文件拆分不一致
- ✅ 大部分模块：单个 `views.py` 文件
- ❌ `users` 模块：`views/auth.py` 和 `views/management.py`
- ❌ `submissions` 模块：`views/common.py`, `views/exam.py`, `views/grading.py`, `views/practice.py`
- ❌ `analytics` 模块：`views/mentor.py`, `views/student.py`, `views/team_manager.py`
- ❌ `tasks` 模块：`views/admin.py`, `views/student.py`
- ❌ `knowledge` 模块：`views/knowledge.py`, `views/tags.py`

## 推荐的命名规范

### 后端URL规范

#### 1. URL路径命名
- 统一使用 **kebab-case**（小写字母 + 连字符）
- 示例：`/api/spot-checks/`, `/api/user-management/`

#### 2. URL文件组织
**选项A（推荐）：统一单文件**
- 每个模块一个 `urls.py` 文件
- 使用 `include()` 组织复杂路由

**选项B：按功能拆分**
- 如果路由较多，可以拆分到 `urls/` 目录
- 命名统一：`urls/auth.py`, `urls/users.py`, `urls/grading.py`
- 示例结构：
  ```
  apps/
    users/
      urls/
        __init__.py
        auth.py
        users.py
    submissions/
      urls/
        __init__.py
        submissions.py
        grading.py
  ```

#### 3. URL名称（name）规范
- 统一使用 **kebab-case**
- 格式：`{module}-{action}` 或 `{module}-{resource}-{action}`
- 示例：
  - `auth-login`
  - `user-list`
  - `knowledge-detail`
  - `submission-create`
  - `grading-detail`

#### 4. URL路径结构规范
- 资源列表：`/api/{resource}/`
- 资源详情：`/api/{resource}/{id}/`
- 资源操作：`/api/{resource}/{id}/{action}/`
- 子资源：`/api/{resource}/{id}/{sub-resource}/`
- 特殊操作：`/api/{resource}/{action}/`（如 `/api/tasks/create/`）

示例：
```
/api/knowledge/              # 列表
/api/knowledge/{id}/         # 详情
/api/knowledge/{id}/publish/ # 操作
/api/knowledge/tags/         # 子资源列表
/api/tasks/create/           # 特殊操作（创建）
```

### 前端路由规范

#### 1. 路由路径命名
- 统一使用 **kebab-case**
- 所有路径都使用 `ROUTES` 常量定义
- 路径命名与后端资源对应，但可简化

#### 2. 路由与API对应关系
建议建立清晰的映射关系：
- 前端路由：用户友好的路径
- API路径：RESTful 资源路径

示例：
```
前端路由                 后端API
/tasks                  /api/tasks/
/tasks/:id              /api/tasks/{id}/
/tasks/create           /api/tasks/create/
/knowledge              /api/knowledge/student/
/admin/knowledge        /api/knowledge/
/quiz/:id               /api/submissions/start/ (POST with quiz_id)
/grading                /api/grading/pending/
/grading/:id            /api/grading/{id}/
```

#### 3. 路由文件组织
建议拆分路由配置：
```
src/
  app/
    router.tsx          # 主路由配置
    routes/
      index.ts          # 导出所有路由配置
      auth.tsx          # 认证相关路由
      knowledge.tsx     # 知识相关路由
      tasks.tsx         # 任务相关路由
      ...
```

### Views文件组织规范

#### 选项A（推荐）：按视图类型拆分
```
views/
  __init__.py
  admin.py       # 管理员视图
  student.py     # 学员视图
  common.py      # 通用视图
```

#### 选项B：按资源拆分
```
views/
  __init__.py
  knowledge.py
  tags.py
  ...
```

#### 选项C：单文件（适用于小型模块）
```
views.py
```

**建议**：
- 如果视图数量 < 5个：使用单文件 `views.py`
- 如果视图数量 >= 5个：按角色或资源拆分到 `views/` 目录
- 拆分标准要统一，建议按角色拆分（admin/student/common）

## 具体改进建议

### 优先级1：高优先级（影响一致性）

1. **统一 submissions 模块的URL文件组织**
   - 将 `urls_grading.py` 重命名为 `urls/grading.py`
   - 将 `urls.py` 重命名为 `urls/submissions.py`
   - 更新主URL配置

2. **统一URL路径命名**
   - 确保所有URL路径使用 kebab-case
   - 检查是否有不一致的路径

3. **统一URL名称（name）**
   - 确保所有URL名称使用 kebab-case
   - 建立统一的命名前缀规范

4. **前端路由路径常量化**
   - 将所有硬编码路径移到 `ROUTES` 常量
   - 确保路径命名一致性

### 优先级2：中优先级（改善组织）

5. **统一views文件组织**
   - 根据视图数量决定是否拆分
   - 如果拆分，统一拆分标准（建议按角色）

6. **统一URL文件组织**
   - 决定是单文件还是多文件
   - 如果多文件，统一命名和组织方式

7. **建立路由-API映射文档**
   - 明确前后端路由对应关系
   - 便于维护和开发

### 优先级3：低优先级（优化）

8. **路由文件拆分**
   - 如果路由配置过大，可以考虑拆分
   - 保持清晰的结构

9. **建立命名规范文档**
   - 在项目文档中记录命名规范
   - 作为开发指南

## 总结

主要问题：
1. URL文件组织不统一（users、submissions 模块特殊）
2. URL路径结构不一致（嵌套 vs 平级）
3. 前端路由部分硬编码，未使用常量
4. Views文件拆分标准不统一

建议优先处理高优先级问题，确保核心命名一致性，然后再优化组织结构。
